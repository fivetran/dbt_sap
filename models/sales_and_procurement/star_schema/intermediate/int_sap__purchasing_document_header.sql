select
    mandt as client_id,
    ebeln as purchasing_document_id,
    bukrs as company_code_id,
    bstyp as purchasing_document_category,
    bsart as purchasing_document_type_id,
    bsakz as control_indicator,
    loekz as deletion_indicator,
    statu as status_purchasing_document,
    case when aedat in ('00000000', ' ') then null else {{ char_yyyymmdd_to_date('aedat') }} end as created_date,
    ernam as created_by,
    pincr as item_number_interval,
    lponr as last_item_number_id,
    lifnr as vendor_id,
    spras as language_key_id,
    zterm as payment_terms,
    zbd1t as payment_in,
    zbd2t as zbd2t,
    zbd3t as zbd3t,
    zbd1p as cash_discount_percentage_1,
    zbd2p as cash_discount_percentage_2,
    ekorg as purchasing_organization_id,
    ekgrp as purchasing_group_id,
    waers as currency_id,
    wkurs as exchange_rate,
    kufix as exchange_rate_fixed,
    case when bedat in ('00000000', ' ') then null else {{ char_yyyymmdd_to_date('bedat') }} end as purchasing_document_date,
    case when kdatb in ('00000000', ' ') then null else {{ char_yyyymmdd_to_date('kdatb') }} end as start_validity_period_date,
    case when kdate in ('00000000', ' ') then null else {{ char_yyyymmdd_to_date('kdate') }} end as end_validity_period_date,
    case when bwbdt in ('00000000', ' ') then null else {{ char_yyyymmdd_to_date('bwbdt') }} end as closing_applications_date,
    case when angdt in ('00000000', ' ') then null else {{ char_yyyymmdd_to_date('angdt') }} end as quotation_deadline_date,
    case when bnddt in ('00000000', ' ') then null else {{ char_yyyymmdd_to_date('bnddt') }} end as binding_period_quotation_date,
    case when gwldt in ('00000000', ' ') then null else {{ char_yyyymmdd_to_date('gwldt') }} end as warranty_date,
    ausnr as bid_invitation_number_id,
    angnr as quotation_number,
    case when ihran in ('00000000', ' ') then null else {{ char_yyyymmdd_to_date('ihran') }} end as quotation_submission_date,
    ihrez as your_reference,
    verkf as salesperson,
    telf1 as vendors_telephone_number,
    llief as supplying_vendor_id,
    kunnr as customer_id,
    konnr as outline_agreement_id,
    abgru as field_not_used,
    autlf as complete_delivery,
    weakt as indicator_goods_receipt_message,
    reswk as supplying_plant_id,
    lblif as field_not_used_id,
    inco1 as incoterms_id,
    inco2 as incoterms_part_2,
    ktwrt as target_header_val,
    submi as collective_number,
    knumv as document_condition_no,
    kalsm as procedure_id,
    stafo as update_group_stats_id,
    lifre as different_invoicing_party_id,
    exnum as number_foreign_trade_id,
    unsez as our_reference,
    logsy as logical_system_id,
    upinc as subitem_interval,
    stako as time_dep_conditions,
    frggr as release_group_id,
    frgsx as release_strategy_id,
    frgke as release_indicator_id,
    frgzu as release_state,
    frgrl as subject_to_release,
    lands as country_tax_return_id,
    lphis as rel_documentation,
    adrnr as address_number_id,
    stceg_l as country_sales_tax_id_number_id,
    stceg as vat_registration_no,
    absgr as reason_cancellation_id,
    addnr as document_number_additional,
    kornr as corr_misc_provis,
    memory as purchase_order_not_yet_complete,
    procstat as purch_doc_proc_state,
    rlwrt as total_at_time_release_val,
    revno as version_number_in_purchasing,
    scmproc as scmproc,
    reason_code as goods_receipt_reason_code,
    memorytype as category_incompleteness,
    rettp as retention_indicator,
    retpc as retention_in_percent,
    dptyp as down_payment_indicator,
    dppct as down_payment_percentage,
    dpamt as down_payment_amount_val,
    case when dpdat in ('00000000', ' ') then null else {{ char_yyyymmdd_to_date('dpdat') }} end as due_down_payment_date,
    msr_id as process_identification_number,
    hierarchy_exists as part_contract_hierarchy,
    threshold_exists as threshold_value_exchange_rates,
    legal_contract as legal_contract_number,
    description as contract_name,
    case when release_date in ('00000000', ' ') then null else {{ char_yyyymmdd_to_date('release_date') }} end as release_contract_date,
    vsart as shipping_type_id,
    handoverloc as handover_location,
    shipcond as shipping_conditions_id,
    incov as incoterms_version_id,
    inco2_l as incoterms_location_1,
    inco3_l as incoterms_location_2,
    force_id as internal_key_force_element,
    force_cnt as internal_version_counter,
    reloc_id as relocation_id,
    reloc_seq_id as relocation_step_id,
    source_logsys as source_logsys,
    fsh_transaction as transaction_number,
    fsh_item_group as item_group,
    fsh_vas_last_item as last_vas_item_number,
    fsh_os_stg_change as os_strategy_specific_fields_change,
    vzskz as interest_calculation_indicator_id,
    fsh_snst_status as snapshot_status,
    pohf_type as document_category,
    case when eq_eindt in ('00000000', ' ') then null else {{ char_yyyymmdd_to_date('eq_eindt') }} end as same_delivery_date,
    eq_werks as same_plant_id,
    fixpo as firm_deal_indicator,
    ekgrp_allow as take_account_purch_group,
    werks_allow as take_account_plants,
    contract_allow as take_account_contracts,
    pstyp_allow as take_account_item_categories,
    fixpo_allow as take_account_fixed_date_purchases,
    key_id_allow as consider_budget,
    aurel_allow as take_account_alloc_table_relevance,
    delper_allow as take_account_dlvy_period,
    eindt_allow as take_account_delivery_date,
    ltsnr_allow as include_vendor_subrange,
    otb_level as otb_check_level,
    otb_cond_type as otb_condition_type_id,
    key_id as unique_number_budget,
    otb_value as required_budget_val,
    otb_curr as otb_currency_id,
    otb_res_value as reserved_budget_val,
    otb_spec_value as special_release_budget_val,
    spr_rsn_profile as otb_reason_profile_special_release,
    budg_type as budget_type,
    otb_status as otb_check_status,
    otb_reason as reason,
    check_type as type_otb_check,
    con_otb_req as otb_relevant_contract,
    con_prebook_lev as indicator_level_contracts,
    con_distr_lev as distrib_using_target_value_or_item,
    hvr_is_deleted as hvr_is_deleted,
    hvr_change_time as hvr_change_time
from {{ ref('stg_sap__ekko') }}
where mandt in ('800')