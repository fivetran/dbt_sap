{{ config(enabled=var('sap_using_kna1', True)) }}

select
    kunnr as customer_id,
    mandt as client_id,
    pmt_office as payment_office_id,
    brsch as industry_key_id,
    katr9 as attribute_9_id,
    uwaer as currency_sales_figure_id,
    kdkg1 as customer_condition_group_1_id,
    pson3 as name_3,
    bran4 as industry_code_4_id,
    ort02 as district,
    _vso_r_matpal as _vso_r_matpal,
    _vso_r_one_sort as _vso_r_one_sort,
    fiskn as fiscal_address_id,
    konzs as group_key,
    etikg as lab_customer_group_id,
    psoo2 as free_description,
    sperz as payment_block,
    katr4 as attribute_4_id,
    telx1 as telex_number,
    crtn as crt_number,
    dtaws as instruction_key_id,
    pstl2 as p_o_box_postal_code,
    datlt as communication_line_no,
    rne as foreign_national_registration,
    name4 as name_4,
    xzemp as alt_payer_in_doc,
    kukla as customer_classification_id,
    _xlso_customer as _xlso_customer,
    name2 as name_2,
    bahne as express_train_station,
    psohs as house_number,
    duns4 as duns_4,
    kdkg2 as customer_condition_group_2_id,
    oidrc as differ_refer_code_id,
    bran5 as industry_code_5_id,
    umsat as annual_sales_val,
    stcd3 as tax_number_3,
    uf as state,
    txlw1 as icms_law_id,
    psoo3 as psoo3,
    rnedate as rne_issuing_date,
    begru as authorization_group_id,
    katr5 as attribute_5_id,
    stcdt as tax_number_type_id,
    duns as duns_number,
    updat as confirmation_date,
    katr10 as attribute_10_id,
    dear1 as indicator_competitor,
    inspatdebi as after_delivery,
    periv as fiscal_year_variant_id,
    _vso_r_pal_ul as _vso_r_pal_ul,
    kdkg3 as customer_condition_group_3_id,
    abrvw as usage_id,
    rg as rg_number,
    stcd4 as tax_number_4,
    loevm as central_deletion_flag,
    txlw2 as ipi_law_id,
    lifnr as vendor_id,
    psoo4 as psoo4,
    _xlso_pref_pay as _xlso_pref_pay,
    counc as county_code_id,
    telfx as fax_number,
    stcd2 as tax_number_2,
    inspbydebi as by_customer,
    dear2 as indicator_sales_partner,
    stcd1 as tax_number_1,
    ort01 as city,
    oid_poreqd as purchase_order_req,
    kdkg4 as customer_condition_group_4_id,
    cvp_xblck as business_purpose_completed_flag,
    faksd as central_billing_block_id,
    ktokd as customer_account_group_id,
    telbx as telebox_number,
    legalnat as legal_nature_id,
    stras as street_and_house_number,
    ccc01 as biochemical_warfare,
    dtams as dme_indicator,
    psoo5 as psoo5,
    j_1kftind as type_industry_id,
    stkzn as natural_person,
    exp as issued_by,
    psotl as title,
    _xlso_partner as _xlso_partner,
    dear3 as indicator_sales_prospect,
    xxipi as customer_is_ipi_exempt,
    niels as nielsen_id,
    umsa1 as umsa1,
    bahns as train_station,
    bubkz as check_digit,
    kdkg5 as customer_condition_group_5_id,
    _vso_r_one_mat as _vso_r_one_mat,
    knurl as uniform_resource_locator,
    xknza as accts_alt_payer,
    dear6 as indicator_consumer,
    pfort as po_box_city,
    stcd5 as tax_number_5,
    cityc as city_code_id,
    ccc02 as nuclear_nonprolif,
    ric as ric_number,
    land1 as country_key_id,
    umjah as year_which_sales_are_given,
    fee_schedule as fee_schedule,
    dear4 as indicator_customer_type_4,
    _xlso_client as _xlso_client,
    erdat as created_on_date,
    _vso_r_dpoint as _vso_r_dpoint,
    teltx as teletex_number,
    ccc03 as national_security,
    oipbl as business_location_id,
    _xlso_sysid as _xlso_sysid,
    rgdate as rg_issuing_date,
    anred as anred,
    ekont as initial_contact_id,
    vbund as trading_partner_id,
    psost as street,
    knrza as alternative_payer_id,
    dear5 as id_default_sold_to_party,
    psofg as processor_group_id,
    jmjah as year_no_given_for,
    tdt as tax_declaration_type_id,
    bbbnr as int_location_no_1,
    regio as region_id,
    alc as agency_location_code_id,
    aufsd as central_order_block_customer_id,
    ccc04 as missile_technology,
    lifsd as central_delivery_block_id,
    cassd as central_sales_block_customer,
    werks as plant_id,
    katr6 as attribute_6_id,
    psois as slaprepr_proced,
    _vso_r_load_pref as _vso_r_load_pref,
    adrnr as address_id,
    civve as id_mainly_non_military_use,
    stkzu as liable_vat,
    fityp as tax_type_id,
    bran1 as industry_code_1_id,
    psovn as first_name,
    comsize as company_size_id,
    j_1kfrepre as name_representative,
    mcod1 as search_term_matchcode_search,
    katr1 as attribute_1_id,
    hzuor as assignment_to_hierarchy,
    xicms as customer_is_icms_exempt,
    indtyp as industry_main_type_id,
    xcpdk as one_time_account,
    lzone as transportation_zone_id,
    sortl as sort_field,
    katr7 as attribute_7_id,
    gform as legal_status_id,
    pson1 as name,
    bran2 as industry_code_2_id,
    stceg as vat_registration_no,
    sperr as central_posting_block,
    locco as city_coordinates,
    uptim as last_change_confirmation_tim,
    cnae as cnae_id,
    mcod2 as mcod2,
    ernam as created_by,
    txjcd as tax_jurisdiction_id,
    katr2 as attribute_2_id,
    confs as confirmation_status,
    telf1 as telephone_1,
    _vso_r_palhgt as _vso_r_palhgt,
    j_1kftbus as type_business_id,
    spras as language_key_id,
    _vso_r_uld_side as _vso_r_uld_side,
    bbsnr as int_location_no_2,
    xsubt as subtrib_group_id,
    katr8 as attribute_8_id,
    jmzah as yearly_number_employees,
    nodel as central_del_block,
    _vso_r_i_no_lyr as _vso_r_i_no_lyr,
    decregpc as declaration_regimen_pis_cofins_id,
    duefl as status_transfer_to_next_release,
    pson2 as pson2,
    cfopc as customers_cfop_category,
    pfach as po_box,
    icmstaxpay as icms_taxpayer_id,
    bran3 as industry_code_3_id,
    suframa as suframa_code,
    exabl as unloading_points,
    pstlz as postal_code,
    stkza as sales_equalizatn_tax,
    psoo1 as psoo1,
    ktocd as reference_acct_group_id,
    telf2 as second_telephone_number,
    knazk as working_time_calendar_id,
    milve as id_mainly_military_use,
    katr3 as attribute_3_id,
    mcod3 as mcod3,
    rpmkr as regional_market,
    _vso_r_pk_mat as _vso_r_pk_mat,
    name3 as name3,
    name1 as name1,
    _fivetran_deleted as _fivetran_deleted,
    _fivetran_synced as _fivetran_synced,
    _fivetran_sap_archived as _fivetran_sap_archived
from {{ ref('stg_sap__kna1') }}
where mandt in ('800')