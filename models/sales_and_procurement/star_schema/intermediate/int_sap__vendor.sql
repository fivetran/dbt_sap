{{ config(enabled=var('sap_using_lfa1', true)) }}

select
    mandt as client_id,
    lifnr as vendor_id,
    land1 as country_key_id,
    name1 as name,
    name2 as name_2,
    name3 as name_3,
    name4 as name_4,
    ort01 as city,
    ort02 as district,
    pfach as po_box,
    pstl2 as p_o_box_postal_code,
    pstlz as postal_code,
    regio as region_id,
    sortl as sort_field,
    stras as street_and_house_number,
    adrnr as address_id,
    mcod1 as search_term_matchcode_search,
    mcod2 as mcod2,
    mcod3 as mcod3,
    anred as title,
    bahns as train_station,
    bbbnr as int_location_no_1,
    bbsnr as int_location_no_2,
    begru as authorization_group_id,
    brsch as industry_key_id,
    bubkz as check_digit,
    datlt as communication_line_no,
    dtams as dme_indicator,
    dtaws as instruction_key_id,
    {{ char_yyyymmdd_to_date('erdat') }} as created_on_date,
    ernam as created_by,
    esrnr as por_subscriber_number,
    konzs as group_key,
    ktokk as vendor_account_group_id,
    kunnr as customer_id,
    lnrza as alternative_payee_id,
    loevm as central_deletion_flag,
    sperr as central_posting_block,
    sperm as central_purchasing_block,
    spras as language_key_id,
    stcd1 as tax_number_1,
    stcd2 as tax_number_2,
    stkza as sales_equalizatn_tax,
    stkzu as liable_vat,
    telbx as telebox_number,
    telf1 as telephone_1,
    telf2 as second_telephone_number,
    telfx as fax_number,
    teltx as teletex_number,
    telx1 as telex_number,
    xcpdk as one_time_account,
    xzemp as payee_in_document,
    vbund as trading_partner_id,
    fiskn as fiscal_address_id,
    stceg as vat_registration_no,
    stkzn as natural_person,
    sperq as function_that_will_be_blocked_id,
    gbort as place_birth,
    {{ char_yyyymmdd_to_date('gbdat') }} as birth_date,
    sexkz as sex,
    kraus as credit_information_number,
    {{ char_yyyymmdd_to_date('revdb') }} as last_review_external_date,
    qssys as vendors_qm_system_id,
    ktock as reference_acct_group_id,
    pfort as po_box_city,
    werks as plant_own_or_external_id,
    ltsna as vendor_sub_range_relevant,
    werkr as indicator_plant_level_relevant,
    plkal as factory_calendar_id,
    duefl as status_transfer_to_next_release,
    txjcd as tax_jurisdiction_id,
    sperz as payment_block,
    scacd as standard_carrier_access_code,
    sfrgr as forwarding_agent_freight_group_id,
    lzone as transportation_zone_id,
    xlfza as accts_alt_payee,
    dlgrp as service_agent_procedure_group_id,
    fityp as tax_type_id,
    stcdt as tax_number_type_id,
    regss as registered_social_insurance,
    actss as social_ins_code_id,
    stcd3 as tax_number_3,
    stcd4 as tax_number_4,
    stcd5 as tax_number_5,
    ipisp as tax_split,
    taxbs as tax_base_in_percentage,
    profs as profession,
    stgdl as stat_grp_service_agent_id,
    emnfr as ext_manufacturer,
    lfurl as uniform_resource_locator,
    j_1kfrepre as name_representative,
    j_1kftbus as type_business_id,
    j_1kftind as type_industry_id,
    confs as confirmation_status,
    {{ char_yyyymmdd_to_date('updat') }} as confirmation_date,
    uptim as last_change_confirmation_tim,
    nodel as central_del_block,
    {{ char_yyyymmdd_to_date('qssysdat') }} as validity_certification_date,
    podkzb as relevant_pod,
    fisku as tax_office_responsible_id,
    stenr as tax_number_at_responsible_tax_authority,
    carrier_conf as carrier_confirmation_is_expected,
    min_comp as micro_company_indicator,
    term_li as terms_liability,
    crc_num as crc_number,
    cvp_xblck as business_purpose_completed_flag,
    rg as rg_number,
    exp as issued_by,
    uf as state,
    {{ char_yyyymmdd_to_date('rgdate') }} as rg_issuing_date,
    ric as ric_number,
    rne as foreign_national_registration,
    {{ char_yyyymmdd_to_date('rnedate') }} as rne_issuing_date,
    cnae as cnae_id,
    legalnat as legal_nature_id,
    crtn as crt_number,
    icmstaxpay as icms_taxpayer_id,
    indtyp as industry_main_type_id,
    tdt as tax_declaration_type_id,
    comsize as company_size_id,
    decregpc as declaration_regimen_pis_cofins_id,
    j_sc_capital as capital_amount_val,
    j_sc_currency as currency_id,
    alc as agency_location_code_id,
    pmt_office as payment_office_id,
    ppa_relevant as vendor_is_ppa_relevant,
    psofg as processor_group_id,
    psois as slaprepr_proced,
    pson1 as pson1,
    pson2 as pson2,
    pson3 as pson3,
    psovn as first_name,
    psotl as psotl,
    psohs as house_number,
    psost as street,
    transport_chain as transportation_chain_id,
    staging_time as staging_time_in_days,
    scheduling_type as scheduling_procedure,
    submi_relevant as cd_relevant_collective_numbering,
    _fivetran_deleted as _fivetran_deleted,
    _fivetran_synced as _fivetran_synced,
    _fivetran_rowid as _fivetran_rowid
from {{ ref('stg_sap__lfa1') }}
where mandt in ('{{ var(sales_and_procurement_mandt_var, [800]) | join(',') }}')
