{{ config(enabled=var('sap_using_t001w', True)) }}

select
    mandt as client_id,
    werks as plant_id,
    fsh_mg_arun_req as order_allocation_run,
    taxiw as tax_indicator_plant_id,
    cityc as city_code_id,
    regio as region_id,
    fabkl as factory_calendar_id,
    mgvlaupd as actual_activities_updated,
    misch as mixed_costing,
    oihvtype as vendor_type,
    ekorg as purchasing_organization_id,
    nodetype as node_type_supply_chain_network_id,
    storetype as store_cat,
    vtweg as distrib_channel_id,
    txnam_ma1 as text_1st_dunning,
    oihcredipi as ipi_credit_allowed,
    kunnr as customer_number_plant_id,
    name1 as name,
    fsh_seaim as season_active_in_inventory_management,
    adrnr as address_id,
    bzirk as sales_district_id,
    spras as language_key_id,
    stras as street_and_house_number,
    zone1 as supply_region_region_supplied_id,
    vkorg as sales_organization_id,
    nschema as structure_name_formation_id,
    dep_store as superior_department_store_id,
    bedpl as activating_requirements_planning,
    lifnr as vendor_number_plant_id,
    pfach as po_box,
    spart as int_co_billing_div_id,
    let03 as _3rd_reminder_exped,
    oilival as exchange_valuation_indicator,
    sourcing as af_srce_det_via_atp,
    wksop as sop_plant,
    kordb as source_list,
    counc as county_code_id,
    vstel as shipping_point_id,
    txnam_ma3 as text_3rd_dunning,
    let02 as _2nd_reminder_exped,
    dvsart as batch_type_dms_used,
    pstlz as postal_code,
    bzqhl as take_regular_vendor_into_account,
    mgvupd as actual_costing,
    pkosa as cost_obj_controlling,
    chazv as batch_status_mgmt,
    txjcd as tax_jurisdiction_id,
    awsls as variance_key_id,
    chazv_old as chazv_old,
    mgvlareval as control_credit_cost_centers,
    bwkey as valuation_area_id,
    vlfkz as plant_category,
    let01 as _1st_reminder_exped,
    txnam_ma2 as text_2nd_dunning,
    fsh_bom_maintenance as control_bom,
    kkowk as conds_at_plant_level,
    j_1bbranch as business_place_id,
    betol as po_tolerance,
    vtbfi as sales_area_detrm,
    name2 as name_2,
    land1 as country_key_id,
    achvm as archiving_marker,
    fprfw as distrib_profile_plant_id,
    ort01 as city,
    iwerk as maintenance_planning_plant_id,
    _fivetran_deleted as _fivetran_deleted,
    _fivetran_synced as _fivetran_synced,
    _fivetran_sap_archived as _fivetran_sap_archived
from {{ ref('stg_sap__t001w') }}
where mandt in ('{{ var("sales_and_procurement_mandt_var", "800") }}')