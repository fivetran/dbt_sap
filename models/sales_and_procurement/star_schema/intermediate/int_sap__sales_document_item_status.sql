{{ config(enabled=var('sap_using_vbup', True)) }}

select
    mandt as client_id,
    posnr as sd_item_id,
    vbeln as sales_document_id,
    uvpak as item_packaging,
    uvvlk as item_deliv,
    mill_vs_vssta as status_sales_order_item,
    pksta as packing_status_item,
    lssta as delivery_block_status_item,
    vlstp as decentralized_whse_processing,
    absta as rejection_status_sd_item,
    fksta as billing_status,
    fkivp as intercompany_billing_status,
    lfgsa as overall_deliv_status,
    rrsta as revenue_determination_status,
    lfsta as delivery_status,
    fksaa as ord_related_bill_st,
    wbsta as goods_movement_status,
    ltsps as stockable_type_switched_into_stand_prod,
    costa as confirmation_status_ale,
    fssta as billing_block_status_items,
    kosta as picking_status_putaway_status,
    uvpik as item_picking_putaway,
    uvfak as item_billing,
    uvall as item,
    rfgsa as overall_status_reference,
    uvprs as pricing_item_is_incomplete,
    lvsta as wm_activity_status,
    rfsta as reference_status,
    cmppj as expt_cred_insurance,
    cmppi as financial_document,
    hdall as delivery_item_not_complete,
    besta as confirmed,
    pdsta as pod_status_on_item_level,
    fsh_ar_stat_itm as arun_status_item_level,
    manek as manual_completion_contract,
    gbsta as overall_status,
    uvwak as item_goods_mvmt,
    dcsta as delay_status,
    uvp05 as customer_reserves_5_item_status,
    uvp02 as customer_reserves_2_item_status,
    uvp04 as item_reserves_4_item_status,
    koqua as pick_confirmation,
    uvp01 as customer_reserves_1_item_status,
    uvp03 as item_reserves_3_item_status,
    _fivetran_deleted as _fivetran_deleted,
    _fivetran_synced as _fivetran_synced,
    _fivetran_sap_archived as _fivetran_sap_archived
from {{ ref('stg_sap__vbup') }}
where mandt in ('{{ var("sales_and_procurement_mandt_var", ["800"]) | join("','") }}')