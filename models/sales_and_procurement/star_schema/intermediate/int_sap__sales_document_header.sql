{{ config(enabled=var('sap_using_vbak', True)) }}

select
	mandt as client_id,
    vbeln as sales_document_id,
    kostl as cost_center_id,
    mahza as number_contacts,
    msr_id as process_identification_number,
    _dataaging as filter_value_aging_date,
    taxk5 as taxclass5_cust_id,
    kvgr4 as customer_group_4_id,
    amtbl as rel_credit_val,
    trvog as transaction_group,
    hb_resdate as resolution_date,
    fmbdat as material_availability_date,
    fsh_vrsn_status as snapshot_status,
    upd_tmstmp as time_stamp,
    auart as sales_document_type_id,
    hb_expdate as expiration_date,
    scheme_grp as group_ref_procedure_id,
    smenr as number_sales_unit_id,
    taxk6 as taxclass6_cust_id,
    fsh_transaction as transaction_number,
    kvgr5 as customer_group_5_id,
    gskst as business_area_from_cost_center_id,
    vkgrp as sales_group_id,
    pay_method as payment_methods,
    ktext as search_term_product_proposal,
    ps_psp_pnr as wbs_element_id,
    faksk as billing_block_in_sd_document_id,
    bnddt as quotation_valid_to_date,
    cmwae as currency_id,
    kokrs as controlling_area_id,
    kunnr as sold_to_party_id,
    betc as business_event_type_code,
    fsh_rereg as release_rule_id,
    tas as treasury_account_symbol,
    cancel_allow as cancellation_allowed,
    fkara as order_rel_bill_type_id,
    taxk7 as taxclass7_cust_id,
    gwldt as guarantee_date,
    psm_budat as posting_in_the_document_date,
    objnr as object_number_at_header_level_id,
    autlf as complete_delivery,
    stwae as statistics_currency_id,
    abhov as pick_up_tim,
    logsysb as logical_system_id,
    fsh_kvgr6 as customer_group_6_id,
    bname as name_orderer,
    taxk8 as taxclass8_cust_id,
    xblnr as reference_document_number,
    mtlaur as marker_low_income_housing_id,
    augru as order_reason_id,
    stafo as update_group_stats_id,
    swenr as business_entity_number_id,
    _xlso_trans_ctxt as _xlso_trans_ctxt,
    abruf_part as check_partner_authorizations,
    cmngv as next_date,
    knkli as credit_account_id,
    spart as division_id,
    proli as dg_mgmt_profile_id,
    enqueue_grp as enqueue_grp,
    vzeit as requested_dely_tim,
    kalcd as proc_camp_determin_id,
    bukrs_vf as company_code_to_be_billed_id,
    fsh_kvgr7 as customer_group_7_id,
    vprgr as proposed_date_type,
    crm_guid as character_field_length_70,
    hityp_pr as hierarchy_type_pricing_id,
    taxk9 as taxclass9_cust_id,
    vgbel as reference_document_id,
    erzet as created_tim,
    ihrez as your_reference,
    submi as collective_number_sd,
    vdatu as requested_delivery_date,
    _xlso_variant_id as _xlso_variant_id,
    abdis as mrp_delivery_schedule_types,
    fsh_kvgr8 as customer_group_8_id,
    ernam as created_by,
    hb_cont_reason as contingency_id,
    netwr as net_val,
    vbkla as original_system,
    vgtyp as preceding_doc_categ,
    sbgrp as credit_rep_group_id,
    stceg_l as tax_destination_country_id,
    fsh_kvgr10 as customer_group_10_id,
    knuma as agreement_id,
    fsh_ss as order_scheduling_strategy_id,
    fsh_cq_check as requirement_relevant,
    xegdr as eu_triangular_deal,
    bstnk as customer_purchase_order_number,
    multi as multiple_promotions,
    sppaym as payment_method,
    lifsk as delivery_block_document_header_id,
    fsh_kvgr9 as customer_group_9_id,
    aedat as changed_date,
    wtysc_clm_hdr as claim_header,
    dat_fzau as cml_delivery_order_qty_date,
    awahr as sales_probability,
    kurst as exchange_rate_type_id,
    gueen as valid_to_date,
    _xlso_so_vald_to as _xlso_so_vald_to,
    cmnup as next_check_date,
    abhod as pick_up_date,
    vkorg as sales_organization_id,
    audat as document_date,
    zuonr as assignment_number,
    angdt as quotation_inquiry_is_valid_from_date,
    vsbed as shipping_conditions_id,
    _xlso_payment_op as _xlso_payment_op,
    rep_freq as reporting_frequency,
    handle as int_id,
    _xlso_so_vald_fm as _xlso_so_vald_fm,
    bstzd as purchase_order_number_supplement,
    taxk1 as alternative_tax_classification_id,
    mahdt as last_customer_contact_date,
    bstdk as customer_purchase_order_date,
    vbeln_grp as mster_contract_number_id,
    handoverloc as handover_location,
    qmnum as notification_id,
    kalsm_ch as search_procedure_id,
    cont_dg as contains_dg,
    cmfre as release_date,
    vtweg as distribution_channel_id,
    telf1 as telephone_number,
    aufnr as order_id,
    phase as sales_phase_id,
    taxk2 as taxclass2_cust_id,
    kvgr1 as customer_group_1_id,
    grupp as customer_credit_group_id,
    fsh_os_stg_change as os_strategy_specific_fields_change,
    abhob as abhob,
    landtx as tax_departure_country_id,
    kalsm as pricing_procedure_id,
    erdat as created_date,
    bpn as business_partner_number_id,
    stage as construction_stage,
    kkber as credit_control_area_id,
    taxk3 as taxclass3_cust_id,
    abrvw as usage_id,
    vbtyp as sd_document_category,
    kvgr2 as customer_group_2_id,
    knumv as document_condition_no,
    guebg as valid_from_date,
    fsh_vas_cg as vas_customer_group_id,
    waerk as sd_document_currency_id,
    vkbur as sales_office_id,
    ctlpc as credit_management_risk_category_id,
    vsnmr_v as sales_document_version_number,
    rplnr as number_payment_card_plan_type_id,
    vbklt as sd_document_indicator,
    mod_allow as modification_allowed,
    taxk4 as tax_classification_4_customer_id,
    _xlso_catalog_id as _xlso_catalog_id,
    kvgr3 as customer_group_3_id,
    fsh_candate as cancellation_date,
    agrzr as accrual_period,
    mill_appl_id as application_id,
    bsark as customer_purchase_order_type_id,
    tm_ctrl_key as control_key,
    gsber as business_area_id,
    _fivetran_deleted as _fivetran_deleted,
    _fivetran_synced as _fivetran_synced,
    _fivetran_sap_archived as _fivetran_sap_archived
from {{ ref('stg_sap__vbak') }}
where mandt in ('{{ var("sales_and_procurement_mandt_var", "800") }}')