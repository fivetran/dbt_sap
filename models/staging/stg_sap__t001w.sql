{{ config(enabled=var('sap_using_t001w', True)) }}

with base as (
    select *
    from {{ ref('stg_sap__t001w_tmp') }}
),

fields as (
    select
        {{
            fivetran_utils.fill_staging_columns(
                source_columns=adapter.get_columns_in_relation(ref('stg_sap__t001w_tmp')),
                staging_columns=get_t001w_columns()
            )
        }}
    from base
),

final as (
    select
        _fivetran_deleted,
        _fivetran_rowid,
        _fivetran_synced,
        _fivetran_sap_archived,
        achvm,
        adrnr,
        awsls,
        bapovar,
        bedpl,
        betol,
        cast(bukrs as {{ dbt.type_string() }}) as bukrs,
        bukrs_glob,
        butxt,
        buvar,
        bwkey,
        bzirk,
        bzqhl,
        chazv,
        chazv_old,
        cityc,
        counc,
        dep_store,
        dkweg,
        dtamtc,
        dtaxr,
        dtprov,
        dttaxc,
        dttdsp,
        dvsart,
        ebukr,
        ekorg,
        fabkl,
        fdbuk,
        fikrs,
        fm_derive_acc,
        fmhrdate,
        fprfw,
        fsh_bom_maintenance,
        fsh_mg_arun_req,
        fsh_seaim,
        fstva,
        fstvare,
        hvr_change_time,
        hvr_is_deleted,
        impda,
        infmt,
        iwerk,
        j_1bbranch,
        kkber,
        kkowk,
        kokfi,
        kopim,
        kordb,
        ktop2,
        ktopl,
        kunnr,
        land1,
        let01,
        let02,
        let03,
        lifnr,
        cast(mandt as {{ dbt.type_string() }}) as mandt,
        mgvlareval,
        mgvlaupd,
        mgvupd,
        misch,
        mregl,
        mwska,
        mwskv,
        name1,
        name2,
        nodetype,
        nschema,
        offsacct,
        oihcredipi,
        oihvtype,
        oilival,
        opvar,
        ort01,
        periv,
        pfach,
        pkosa,
        pp_pdate,
        pst_per_var,
        pstlz,
        rcomp,
        regio,
        sourcing,
        spart,
        spras,
        stceg,
        storetype,
        stras,
        surccm,
        taxiw,
        txjcd,
        txkrs,
        txnam_ma1,
        txnam_ma2,
        txnam_ma3,
        umkrs,
        vkorg,
        vlfkz,
        vstel,
        vtbfi,
        vtweg,
        waabw,
        waers,
        werks,
        wfvar,
        wksop,
        wt_newwt,
        xbbba,
        xbbbe,
        xbbbf,
        xbbko,
        xbbsc,
        xcession,
        xcos,
        xcovr,
        xeink,
        xextb,
        xfdis,
        xfdmm,
        xfdsd,
        xfmca,
        xfmcb,
        xfmco,
        xgjrv,
        xgsbe,
        xjvaa,
        xkdft,
        xkkbi,
        xmwsn,
        xnegp,
        xprod,
        xskfn,
        xslta,
        xsplt,
        xstdt,
        xvalv,
        xvatdate,
        xvvwa,
        zone1
    from fields
)

select *
from final
