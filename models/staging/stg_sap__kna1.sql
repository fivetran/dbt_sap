{{ config(enabled=var('sap_using_kna1', True)) }}

with base as (

    select * 
    from {{ ref('stg_sap__kna1_tmp') }}
),

fields as (

    select
        {{
            fivetran_utils.fill_staging_columns(
                source_columns=adapter.get_columns_in_relation(ref('stg_sap__kna1_tmp')),
                staging_columns=get_kna1_columns()
            )
        }}
    from base
),

final as (

    select
        _vso_r_dpoint,
        _vso_r_i_no_lyr,
        _vso_r_load_pref,
        _vso_r_matpal,
        _vso_r_one_mat,
        _vso_r_one_sort,
        _vso_r_pal_ul,
        _vso_r_palhgt,
        _vso_r_pk_mat,
        _vso_r_uld_side,
        _xlso_client,
        _xlso_customer,
        _xlso_partner,
        _xlso_pref_pay,
        _xlso_sysid,
        cast(mandt as {{ dbt.type_string() }}) as mandt,
        kunnr,
        pmt_office,
        brsch,
        katr9,
        uwaer,
        kdkg1,
        pson3,
        bran4,
        ort02,
        fiskn,
        konzs,
        etikg,
        psoo2,
        sperz,
        katr4,
        telx1,
        crtn,
        dtaws,
        pstl2,
        datlt,
        rne,
        name4,
        xzemp,
        kukla,
        name2,
        bahne,
        psohs,
        duns4,
        kdkg2,
        oidrc,
        bran5,
        umsat,
        stcd3,
        uf,
        txlw1,
        psoo3,
        rnedate,
        begru,
        katr5,
        stcdt,
        duns,
        updat,
        katr10,
        dear1,
        inspatdebi,
        periv,
        kdkg3,
        abrvw,
        rg,
        stcd4,
        loevm,
        txlw2,
        lifnr,
        psoo4,
        counc,
        telfx,
        stcd2,
        inspbydebi,
        dear2,
        stcd1,
        ort01,
        oid_poreqd,
        kdkg4,
        cvp_xblck,
        faksd,
        ktokd,
        telbx,
        legalnat,
        stras,
        ccc01,
        dtams,
        psoo5,
        j_1kftind,
        stkzn,
        exp,
        psotl,
        dear3,
        xxipi,
        niels,
        umsa1,
        bahns,
        bubkz,
        kdkg5,
        knurl,
        xknza,
        dear6,
        pfort,
        stcd5,
        cityc,
        ccc02,
        ric,
        land1,
        umjah,
        fee_schedule,
        dear4,
        erdat,
        teltx,
        ccc03,
        oipbl,
        rgdate,
        anred,
        ekont,
        vbund,
        psost,
        knrza,
        dear5,
        psofg,
        jmjah,
        tdt,
        bbbnr,
        regio,
        alc,
        aufsd,
        ccc04,
        lifsd,
        cassd,
        werks,
        katr6,
        psois,
        adrnr,
        civve,
        stkzu,
        fityp,
        bran1,
        psovn,
        comsize,
        j_1kfrepre,
        mcod1,
        katr1,
        hzuor,
        xicms,
        indtyp,
        xcpdk,
        lzone,
        sortl,
        katr7,
        gform,
        pson1,
        bran2,
        stceg,
        sperr,
        locco,
        uptim,
        cnae,
        mcod2,
        ernam,
        txjcd,
        katr2,
        confs,
        telf1,
        j_1kftbus,
        spras,
        bbsnr,
        xsubt,
        katr8,
        jmzah,
        nodel,
        decregpc,
        duefl,
        pson2,
        cfopc,
        pfach,
        icmstaxpay,
        bran3,
        suframa,
        exabl,
        pstlz,
        stkza,
        psoo1,
        ktocd,
        telf2,
        knazk,
        milve,
        katr3,
        mcod3,
        rpmkr,
        name3,
        name1,
        _fivetran_deleted,
        _fivetran_synced,
        _fivetran_sap_archived

    from fields
)

select *
from final